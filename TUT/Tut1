#Question 1.4
# Load necessary libraries
library(datasets)  # for the Old Faithful dataset
library(KernSmooth)  # for KDE and local polynomial regression

# Load the Old Faithful dataset
data("faithful")

# Part (a): Compute and plot a 2D KDE
# Extract the data
eruptions <- faithful$eruptions
waiting <- faithful$waiting

# Compute the 2D KDE
kde2d_result <- bkde2D(cbind(eruptions, waiting), bandwidth=c(0.1, 1))

# Plot the 2D KDE
filled.contour(kde2d_result$x1, kde2d_result$x2, kde2d_result$fhat,
               color.palette=colorRampPalette(c("white", "blue", "yellow", "red", "darkred")),
               xlab="Eruption duration (minutes)", ylab="Waiting time (minutes)",
               main="2D KDE of Old Faithful Eruptions")

# Part (b): Nonparametric regression using local polynomials
# Fit the local polynomial regression
locpoly_result <- locpoly(x=eruptions, y=waiting, bandwidth=0.3, degree=2)

# Plot the nonparametric regression result
plot(eruptions, waiting, xlab="Eruption duration (minutes)", ylab="Waiting time (minutes)",
     main="Local Polynomial Regression", pch=19, col="gray")
lines(locpoly_result$x, locpoly_result$y, col="red", lwd=2)

